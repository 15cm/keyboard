<?xml version="1.0" encoding="UTF-8"?>
<root>
    <item>
        <!--      Inspired by and adapted from Steve Losh's "Modern Space Cadet" post:      http://stevelosh.com/blog/2012/10/a-modern-space-cadet/#hyper    -->
        <name>Hyper Mode</name>
        <item>
            <appendix>OS X doesn't have a native Hyper key. Let's define Hyper as Virtual key: MY_HYPER.</appendix>
            <appendix>With a new modifier key defined, we open a whole world of possibilities.</appendix>
            <!-- F19 to Hyper BEGIN -->
            <item>
                <name>F19(Caps Lock) to Escape or Hold for Hyper(Control_R)</name>
                <identifier>com.15-cm.f19_hyper</identifier>
                <autogen>
                    __KeyOverlaidModifier__ KeyCode::F19, KeyCode::CONTROL_R, KeyCode::ESCAPE
                </autogen>
            </item>
            <!-- F19 to Hyper END -->
            <!-- Double Press for CapsLock BEGIN -->
            <!-- <item>
                <name>Double-tap Shift_R for CapsLock</name>
                <identifier>com.15-cm.double_shiftR_to_capslock</identifier>
                <autogen>__DoublePressModifier__ KeyCode::SHIFT_R, KeyCode::SHIFT_R, KeyCode::CAPSLOCK</autogen>
            </item> -->
            <!-- Double Press for CapsLock END -->

            <!-- CONTROL_R to CapsLock BEGIN -->
            <item>
                <name>Control_R for CapsLock (press Control_R only)</name>
                <identifier>com.15-cm.double_controlR_to_capslock</identifier>
                <autogen>__KeyOverlaidModifier__ KeyCode::CONTROL_R, KeyCode::VK_LAZY_CONTROL_R, KeyCode::CAPSLOCK</autogen>
            </item>
            <!-- CONTROL_R to CapsLock END -->

            <!-- editors define BEGIN -->
            <appdef>
                <appname>EDITOR</appname>
                <equal>com.runningwithcrayons.Alfred-2</equal>
                <equal>com.github.atom</equal>
                <prefix>com.sublimetext</prefix>
                <prefix>com.jetbrains</prefix>
                <equal>com.google.android.studio</equal>
                <equal>com.googlecode.iterm2</equal>
                <equal>com.apple.com.Terminal</equal>
            </appdef>
            <!-- editors define END -->
            <!-- Vim Emulator BEGIN -->
            <item>
                <appendix>Vim Emulator With Hyper Key</appendix>
                <item>
                    <name>Hyper + h/j/k/l to Cursor Left/Down/Up/Right</name>
                    <identifier>com.15-cm.hyper_hjkl_for_cursor_ldur</identifier>
                    <autogen>
                        __KeyToKey__ KeyCode::H, ModifierFlag::CONTROL_R | ModifierFlag::NONE, KeyCode::CURSOR_LEFT
                    </autogen>
                    <autogen>
                        __KeyToKey__ KeyCode::J, ModifierFlag::CONTROL_R | ModifierFlag::NONE, KeyCode::CURSOR_DOWN
                    </autogen>
                    <autogen>
                        __KeyToKey__ KeyCode::K, ModifierFlag::CONTROL_R | ModifierFlag::NONE, KeyCode::CURSOR_UP
                    </autogen>
                    <autogen>
                        __KeyToKey__ KeyCode::L, ModifierFlag::CONTROL_R | ModifierFlag::NONE, KeyCode::CURSOR_RIGHT
                    </autogen>
                </item>
                <item>
                    <name>Hyper + f/b to PgDn/PgUp</name>
                    <appendix>(Disabled in terminal and text edtitor like environment)</appendix>
                    <identifier>com.15-cm.hyper_fb_for_pgUppgDn</identifier>
                    <block>
                        <not>EDITOR</not>
                        <autogen>
                            __KeyToKey__ KeyCode::F, ModifierFlag::CONTROL_R | ModifierFlag::NONE, KeyCode::PAGEDOWN
                        </autogen>
                        <autogen>
                            __KeyToKey__ KeyCode::B, ModifierFlag::CONTROL_R | ModifierFlag::NONE, KeyCode::PAGEUP
                        </autogen>
                    </block>
                </item>
            </item>
            <!-- Vim Emulator END -->
        </item>
    </item>
    <!-- Specify input source by Option_L BEGIN-->
    <!-- define input source BEGIN-->
    <inputsourcedef>
        <name>EN</name>
        <languagecode>en</languagecode>
    </inputsourcedef>
    <inputsourcedef>
        <name>CHS</name>
        <languagecode>zh-Hans</languagecode>
    </inputsourcedef>
    <inputsourcedef>
        <name>JP</name>
        <languagecode>ja</languagecode>
    </inputsourcedef>
    <!-- define input source END -->
    <!-- define VK to change input source BEGIN -->
    <vkchangeinputsourcedef>
        <name>KeyCode::VK_CHANGE_INPUTSOURCE_MY_US</name>
        <languangecode>en</languangecode>
        <inputsourceid_equal>com.apple.keylayout.US</inputsourceid_equal>
    </vkchangeinputsourcedef>
    <!-- <vkchangeinputsourcedef>
    <name>KeyCode::VK_CHANGE_INPUTSOURCE_MY_CHS</name>
    <languagecode>zh-Hans</languagecode>
    <inputsourceid_equal>com.baidu.inputmethod.BaiduIM.pinyin</inputsourceid_equal>
</vkchangeinputsourcedef> -->
    <!-- <vkchangeinputsourcedef>
<name>KeyCode::VK_CHANGE_INPUTSOURCE_MY_JP</name>
<inputsourceid_equal>com.apple.inputmethod.Kotoeri.Japanese</inputsourceid_equal>
</vkchangeinputsourcedef> -->
    <!-- define VK to change input source END -->
    <item>
        <name>Easily Change Input Source</name>
        <item>
            <appendix>It's annoying that we have to focus on what input source we are using now</appendix>
            <appendix>when switching language we type in.</appendix>
            <appendix>These hotkeys allow us to easily switch between or sepcify our input sources</appendix>
            <item>
                <name>Shift_R to swich between English and Chinese</name>
                <appendix>(You'd better disable 'shift to switch Chinese and English' in Baidu/Sougou Pinyin beforehand)</appendix>
                <identifier>com.15-cm.shift_switch_en_zh</identifier>
                <block>
                    <inputsource_only>EN</inputsource_only>
                    <autogen>
                        __KeyOverlaidModifier__ KeyCode::SHIFT_R, KeyCode::VK_LAZY_SHIFT_R, KeyCode::F18
                    </autogen>
                </block>
                <block>
                    <inputsource_only>CHS</inputsource_only>
                    <autogen>
                        __KeyOverlaidModifier__ KeyCode::SHIFT_R, KeyCode::VK_LAZY_SHIFT_R,
                        <!-- the same as 'switch_to_input_source_1st' -->
                        KeyCode::VK_CHANGE_INPUTSOURCE_MY_US, KeyCode::VK_WAIT_10MS, KeyCode::F18, KeyCode::VK_WAIT_10MS, KeyCode::F18, KeyCode::VK_WAIT_50MS, KeyCode::VK_CHANGE_INPUTSOURCE_MY_US
                    </autogen>
                </block>
            </item>
            <item>
                <name>Specify Input Source</name>
                <item>
                    <name>Control_L + Command_R + F11 to F18(F18: set as system hotkey to switch input source)</name>
                    <appendix>(This hotkey must be enabled as the following hotkeys are all based on F18, which is set as system shortcut to switch input source)</appendix>
                    <identifier>com.15-cm.ctrl_l_command_r_f11_to_f18</identifier>
                    <autogen>
                        __KeyToKey__ KeyCode::F11, ModifierFlag::CONTROL_L | ModifierFlag::COMMAND_R | ModifierFlag::NONE, KeyCode::F18
                    </autogen>
                </item>
                <item>
                    <name>Change input source to EN(1st) by Option_L + A</name>
                    <identifier>com.15-cm.switch_to_input_source_1st</identifier>
                    <autogen>
                        __KeyToKey__ KeyCode::A, ModifierFlag::OPTION_L | ModifierFlag::NONE, KeyCode::VK_CHANGE_INPUTSOURCE_MY_US, KeyCode::VK_WAIT_10MS, KeyCode::F18, KeyCode::VK_WAIT_10MS, KeyCode::F18, KeyCode::VK_WAIT_50MS, KeyCode::VK_CHANGE_INPUTSOURCE_MY_US
                    </autogen>
                </item>
                <item>
                    <name>Change input source to input source 2nd by Option_L + S</name>
                    <identifier>com.15-cm.switch_to_input_source_2nd</identifier>
                    <autogen>
                        __KeyToKey__ KeyCode::S, ModifierFlag::OPTION_L | ModifierFlag::NONE, KeyCode::VK_CHANGE_INPUTSOURCE_MY_US, KeyCode::F18, KeyCode::VK_WAIT_100MS
                    </autogen>
                </item>
                <item>
                    <name>Change input source to input source 3rd by Option_L + D</name>
                    <identifier>com.15-cm.input_source_3rd</identifier>
                    <autogen>
                        __KeyToKey__ KeyCode::D, ModifierFlag::OPTION_L | ModifierFlag::NONE, KeyCode::VK_CHANGE_INPUTSOURCE_MY_US, KeyCode::VK_WAIT_10MS, KeyCode::F18, KeyCode::VK_WAIT_10MS, KeyCode::F18
                    </autogen>
                </item>
            </item>
            <!-- Specify input source by Option_L END-->
        </item>
    </item>
    <!-- define external keyboard BEGIN-->
    <devicevendordef>
        <vendorname>CHERRY</vendorname>
        <vendorid>0x046a</vendorid>
    </devicevendordef>
    <deviceproductdef>
        <productname>EXTERNAL_KEYBOARD</productname>
        <productid>0x0011</productid>
    </deviceproductdef>
    <!-- define external keyboard END-->
    <!-- Adjustment for external keyboard BEGIN -->
    <item>
        <name>Swap Option with Command on external keyboard</name>
        <item>
            <name>Swap Option_L with Command_L</name>
            <identifier>com.15-cm.ex_swap_L_opt_cmd</identifier>
            <device_only>DeviceVendor::CHERRY, DeviceProduct::EXTERNAL_KEYBOARD</device_only>
            <autogen>
                __KeyToKey__ KeyCode::OPTION_L, KeyCode::COMMAND_L
            </autogen>
            <autogen>__KeyToKey__ KeyCode::COMMAND_L, KeyCode::OPTION_L</autogen>
        </item>
        <item>
            <name>Swap Option_R with Command_R</name>
            <identifier>com.15-cm.ex_swap_R_opt_cmd</identifier>
            <device_only>DeviceVendor::CHERRY, DeviceProduct::EXTERNAL_KEYBOARD</device_only>
            <autogen>
                __KeyToKey__ KeyCode::OPTION_R, KeyCode::COMMAND_R
            </autogen>
            <autogen>__KeyToKey__ KeyCode::COMMAND_R, KeyCode::OPTION_R</autogen>
        </item>
    </item>
    <!-- Adjustment for external keyboard END -->
</root>
